# Το Stashing

Τι κάνετε αν εργάζεστε σε ένα μεγάλο κώδικα και ξαφνικά χρειάζεστε να αλλάξετε το κλαδί από το οποίο εργάζεστε προς ένα άλλο κλαδί; Αφού το έργο δεν είναι ολοκληρωμένο και χωρίς καμία δοκιμή, πιθανώς δεν θέλετε να κάνετε commit. Αλλά δεν μπορείτε να μεταβείτε στο άλλο κλαδί χωρίς να κάνετε commit τις αλλαγές, διότι το Git δεν θα σας επιτρέψει να διακόψετε αυτήν τη ροή. Τι κάνουμε τότε; Πώς αποτρέπουμε ένα άσκοπο commit, ενώ είμαστε σε θέση να μεταβούμε σε άλλα κλαδιά; Αυτό είναι αυτό που καλύπτεται σε αυτό το εγχειρίδιο.

## Αποθήκευση της εργασίας σας

Ας υποθέσουμε ότι εργάζεστε σε ένα κλαδί ενός έργου όπου έχετε αλλάξει μερικά αρχεία. Τώρα, αν εκτελέσετε την εντολή ```git status```, μπορείτε να δείτε τις αλλαγές στα αρχεία.

```
$ git status
# On branch master
# Changes to be committed:
#   (use "git reset HEAD <file>..." to unstage)
#
#      modified:   index.html
#
# Changes not staged for commit:
#   (use "git add <file>..." to update what will be committed)
#
#      modified:   lib/simplegit.rb
#
```

Τώρα θέλετε να αλλάξετε το κλαδί, αλλά δεν θέλετε να κάνετε commit τις αλλαγές ακόμα· γι 'αυτό θα αποθηκεύσετε τις αλλαγές. Για να προσθέσετε μια νέα αποθήκη στο στοίβα σας, εκτελέστε την εντολή ```git stash```:

```
$ git stash
Saved working directory and index state \
  "WIP on master: 049d078 added the index file"
HEAD is now at 049d078 added the index file
(To restore them type "git stash apply")
```

Τώρα ο κατάλογος εργασίας σας είναι καθαρός, χρησιμοποιήστε το ```git status```:

```
$ git status
# On branch master
nothing to commit, working directory clean
```

Τώρα μπορείτε να μεταβείτε σε οποιοδήποτε κλαδί και να κάνετε τη δουλειά σας. Οι αποθηκευμένες αλλαγές σας αποθηκεύονται ως στοίβα. Για να δείτε ποιες αποθηκεύσεις έχετε αποθηκεύσει στη στοίβα, μπορείτε να χρησιμοποιήσετε την εντολή ```git stash list```:

```
$ git stash list
stash@{0}: WIP on master: 049d078 added the index file
stash@{1}: WIP on master: c264051 Revert "added file_size"
stash@{2}: WIP on master: 21d80a5 added number to log
```

Αν θέ

λετε να επαναφέρετε τις αλλαγές που αποθηκεύσατε, μπορείτε να χρησιμοποιήσετε την εντολή ```git stash apply```. Χρησιμοποιώντας αυτήν την εντολή, μπορείτε να εφαρμόσετε ξανά το πιο πρόσφατο αρχείο που αποθηκεύσατε. Για να εφαρμόσετε άλλο αρχείο, μπορείτε να το καθορίσετε κατά το όνομά του όπως: ```git stash apply <stash-name>```, αντί για ```<stash-name>``` γράψτε το όνομα της αποθήκευσης που χρειάζεστε να εφαρμόσετε ξανά.

```
$ git stash apply
# On branch master
# Changes not staged for commit:
#   (use "git add <file>..." to update what will be committed)
#
#      modified:   index.html
#      modified:   lib/simplegit.rb
#
```

Μπορείτε να δείτε ότι το git αναθεωρεί το αρχείο που δεν είχατε κάνει commit όταν αποθηκεύσατε την αποθήκευση. Σε αυτήν την περίπτωση, είχατε έναν καθαρό κατάλογο εργασίας όταν προσπαθήσατε να εφαρμόσετε την αποθήκευση, και προσπαθήσατε να την εφαρμόσετε στο ίδιο κλαδί από το οποίο την αποθηκεύσατε· αλλά η αποθήκευση δεν είναι απαραίτητη για να εφαρμόσετε με επιτυχία μια αποθήκευση. Μπορείτε να αποθηκεύσετε μια αποθήκευση σε ένα κλαδί, να μεταβείτε σε ένα άλλο κλαδί αργότερα και να εφαρμόσετε ξανά τις αλλαγές στο νέο κλαδί. Μπορείτε επίσης να έχετε τροποποιημένα και μη καταχωρημένα αρχεία στον κατάλογο εργασίας σας όταν εφαρμόζετε μια αποθήκευση, το git δίνει συγχωνευτικές συγκρούσεις αν τίποτα δεν ισχύει πλέον καθαρά.

Οι αλλαγές που έγιναν στα αρχεία σας εφαρμόζονται ξανά, αλλά το αρχείο που είχατε καταχωρήσει δεν είχε καταχωρηθεί ξανά. Για να το κάνετε αυτό, πρέπει να εκτελέσετε την εντολή ```git stash apply``` με το ```--index``` για να πείτε στην εντολή να εφαρμόσει ξανά τις καταχωρημένες αλλαγές. Εάν είχατε τρέξει αυτήν αντί για αυτήν, θα επιστρέφατε στην αρχική σας θέση:

```
$ git stash apply --index
# On branch master
# Changes to be committed:
#   (use "git reset HEAD <file>..." to unstage)
#
#      modified:   index.html
#
# Changes not staged for commit:
#   (use "git add <file>..." to update what will be committed)
#
#      modified:   lib/simplegit.rb
#
```

Η εντολή εφαρμογής αφορά μόνο το εργαζόμενο αρχείο, αλλά το έχετε ακόμα στη στοίβα σας. Για να το αφαιρέσετε, μπορείτε να εκτελέσετε την εντολή ```git stash drop``` με το όνομα της απ

οθήκευσης προς αφαίρεση.

```
$ git stash list
stash@{0}: WIP on master: 049d078 added the index file
stash@{1}: WIP on master: c264051 Revert "added file_size"
stash@{2}: WIP on master: 21d80a5 added number to log
$ git stash drop stash@{0}
Dropped stash@{0} (364e91f3f268f0900bc3ee613f9f733e82aaed43)
```

Μπορείτε να χρησιμοποιήσετε την εντολή ```git stash pop``` για να ακυρώσετε τις τελευταίες αλλαγές και να τις αφαιρέσετε από τη στοίβα αποθήκευσης.

## Αναίρεση αποθήκευσης (Un-applying a Stash)

Σε ορισμένες περιπτώσεις, θέλετε να εφαρμόσετε αποθηκευμένες αλλαγές, να κάνετε κάποια δουλειά, αλλά να αναιρέσετε τις αλλαγές που προήλθαν αρχικά από την αποθήκευση. Το Git δεν παρέχει εντολή όπως το ```git unapply```, αλλά είναι δυνατό να επιτευχθεί αυτή η επίδραση απλά ανακτώντας το παράστατο που συνδέεται με μια αποθήκευση και εφαρμόζοντάς το αντίστροφα:

```$ git stash show -p stash@{0} | git apply -R```

Και πάλι, εάν δεν καθορίσετε μια αποθήκευση, το Git υποθέτει την πιο πρόσφατη αποθήκευση:

```$ git stash show -p | git apply -R```

Μπορείτε να θέλετε να δημιουργήσετε ένα ψευδώνυμο και να προσθέσετε αποτελεσματικά μια εντολή ```stash-unapply``` στο Git σας. Για παράδειγμα:

```
$ git config --global alias.stash-unapply '!git stash show -p | git apply -R'
$ git stash apply
$ #... δουλειά δουλειά δουλειά
$ git stash-unapply
```

## Δημιουργία κλαδιού από την αποθήκευση

Εάν αποθηκεύσετε κάποια εργασία, την αφήσετε εκεί για κάποιο διάστημα και συνεχίσετε στο κλαδί από το οποίο αποθηκεύσατε την εργασία, ενδέχεται να αντιμετωπίσετε ένα πρόβλημα κατά την επαναφορά της εργασίας. Εάν η εφαρμογή προσπαθεί να τροποποιήσε

ι ένα αρχείο που έχετε τροποποιήσει από τότε, θα λάβετε σύγκρουση συγχώνευσης και θα πρέπει να την επιλύσετε. Εάν θέλετε έναν ευκολότερο τρόπο για να δοκιμάσετε ξανά τις αποθηκευμένες αλλαγές, μπορείτε να εκτελέσετε την εντολή ```git stash branch```, η οποία δημιουργεί ένα νέο κλαδί για εσάς, ελέγχει την αναφορά στην οποία βρισκόσασταν όταν αποθηκεύσατε την εργασία σας, εφαρμόζει ξανά την εργασία σας εκεί και στη συνέχεια απορρίπτει την αποθήκευση αν εφαρμοστεί επιτυχώς:

```
$ git stash branch testchanges
Switched to a new branch "testchanges"
# On branch testchanges
# Changes to be committed:
#   (use "git reset HEAD <file>..." to unstage)
#
#      modified:   index.html
#
# Changes not staged for commit:
#   (use "git add <file>..." to update what will be committed)
#
#      modified:   lib/simplegit.rb
#
Dropped refs/stash@{0} (f0dfc4d5dc332d1cee34a634182e168c4efc3359)
```

Αυτό είναι ένα ωραίο συντόμευση για να επαναφέρετε εύκολα την αποθηκευμένη εργασία και να δουλέψετε πάνω σε αυτήν σε ένα νέο κλαδί.